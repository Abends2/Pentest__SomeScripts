param (
    [string]$domain
)

# Установка кодовой страницы UTF-8
chcp 65001 | Out-Null

$banner = @"
  ______ _____ _   _ _____    _____   _____ 
 |  ____|_   _| \ | |  __ \  |  __ \ / ____|
 | |__    | | |  \| | |  | | | |  | | |     
 |  __|   | | | . ' | |  | | | |  | | |     
 | |     _| |_| |\  | |__| | | |__| | |____ 
 |_|    |_____|_| \_|_____/  |_____/ \_____|

      (made with <3 by o1d_bu7_go1d)

"@

Write-Host $banner -ForegroundColor DarkMagenta

if (-not $domain) {
    $domain = Read-Host 'Enter the domain name (example.local)'
    if ($domain -eq "") {
    	Write-Host "Usage: .\FindDC.ps1 <domain.name> or enter the domain in a script`n" -ForegroundColor Green
        exit 1
    } 
}

Write-Host "Scanning for $domain...`n" -ForegroundColor Green

# Определение словаря команд
$commands_dict = @{
    "kerberos_tcp" = { nslookup -type=srv _kerberos._tcp.$domain }
    "kerberos_udp" = { nslookup -type=srv _kerberos._udp.$domain }
    "kpasswd_tcp" = { nslookup -type=srv _kpasswd._tcp.$domain }
    "kpasswd_udp" = { nslookup -type=srv _kpasswd._udp.$domain }
    "ldap_tcp" = { nslookup -type=srv _ldap._tcp.$domain }
    "ldap_tcp_dc_msdcs" = { nslookup -type=srv _ldap._tcp.dc._msdcs.$domain }
    "ldap_tcp_pdc_msdcs" = { nslookup -type=srv _ldap._tcp.pdc._msdcs.$domain }
}

# Перебор команд и выполнение каждой из них
foreach ($command in $commands_dict.Keys) {
    Write-Host "=======================================================================" -ForegroundColor Cyan
    Write-Host "Executing command: $command" -ForegroundColor Green

    # Выполнение команды и вывод результата
    try {
        $result = & $commands_dict[$command]
        Write-Host $result
    }
    catch {
        Write-Host "An error occurred while executing $command" -ForegroundColor Red
    }

    Write-Host "`nCommand execution completed.`n" -ForegroundColor Green
}

Write-Host "Scan complete." -ForegroundColor Green
