#!/bin/bash

# Установка кодировки UTF-8
export LANG=en_US.UTF-8

# Приветственное сообщение с цветами
banner() {
    echo -e "\033[0;35m"
    cat << "EOF"
  ______ _____ _   _ _____    _____   _____ 
 |  ____|_   _| \ | |  __ \  |  __ \ / ____|
 | |__    | | |  \| | |  | | | |  | | |     
 |  __|   | | | . ' | |  | | | |  | | |     
 | |     _| |_| |\  | |__| | | |__| | |____ 
 |_|    |_____|_| \_|_____/  |_____/ \_____|

      (made with <3 by o1d_bu7_go1d)

EOF
    echo -e "\033[0m"
}

# Вывод приветственного сообщения
banner

# Проверка и получение домена
if [ -z "$1" ]; then
    read -p "Enter the domain name (example.local): " domain
else
    domain=$1
fi

if [ -z "$domain" ]; then
    echo -e "\033[0;31mUsage: $0 <domain.name> or enter the domain in the script\n\033[0m"
    exit 1
fi

echo -e "\033[0;32mScanning for $domain...\n\033[0m"

# Определение массива команд
commands=(
    "kerberos_tcp:nslookup -type=srv _kerberos._tcp.$domain"
    "kerberos_udp:nslookup -type=srv _kerberos._udp.$domain"
    "kpasswd_tcp:nslookup -type=srv _kpasswd._tcp.$domain"
    "kpasswd_udp:nslookup -type=srv _kpasswd._udp.$domain"
    "ldap_tcp:nslookup -type=srv _ldap._tcp.$domain"
    "ldap_tcp_dc_msdcs:nslookup -type=srv _ldap._tcp.dc._msdcs.$domain"
    "ldap_tcp_pdc_msdcs:nslookup -type=srv _ldap._tcp.pdc._msdcs.$domain"
)

# Перебор команд и выполнение каждой из них
for cmd in "${commands[@]}"; do
    key=${cmd%%:*}
    command=${cmd#*:}

    echo -e "\033[0;36m=======================================================================\033[0m"
    echo -e "\033[0;34mExecuting command: $key\033[0m"
    
    # Выполнение команды и вывод результата
    if ! result=$(eval "$command" 2>&1); then
        echo -e "\033[0;31mAn error occurred while executing $key\033[0m"
        echo -e "\033[0;31m$result\033[0m"
    else
        echo -e "$result"
    fi

    echo -e "\033[0;32mCommand execution completed.\n\033[0m"
done

echo -e "\033[0;32mScan complete.\033[0m"
